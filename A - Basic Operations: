#include <iostream>
#include <cmath>
#include <vector>
#include <algorithm>
#include <cmath>     
#include <map>       

using namespace std;


// Functions for Basic Operations (Part A)

void takeInput(double& num1, double& num2) {
    cout << "Enter first number: ";
    cin >> num1;
    cout << "Enter second number: ";
    cin >> num2;
}

double add(double a, double b) {
    return a+b;
}

double subtract(double a, double b) {
    return a-b;
}

double multiply(double a, double b) {
    return a*b;
}

double divide(double a, double b) {
    if (b==0) {
        cout << "Error! Division by Zero."<< endl; 
        return 0; 
    }
    return a/b;
}

double toRadians(double degree) {
    return degree * (M_PI / 180.0);
}

double sine(double angle, bool isDegree = true) {
    if (isDegree) {
        angle = toRadians(angle);
    }
    return sin(angle);
}

double cosine(double angle, bool isDegree = true) {
    if (isDegree) {
        angle = toRadians(angle);
    }
    return cos(angle);
}

double tangent(double angle, bool isDegree = true) {
    if (isDegree) {
        angle = toRadians(angle);
    }
    return tan(angle);
}

double arcsine(double value) {
    // arcsin returns in radians
    return asin(value);
}

double arccosine(double value) {
    // arccos returns in radians
    return acos(value);
}

double arctangent(double value) {
    // arctan returns in radians
    return atan(value);
}

// Functions for Algebraic Operations

long long factorial(int n) {
    long long result = 1;
    for (int i = 2; i <= n; ++i) {
        result *= i;
    }
    return result;
}

double nthRoot(double value, double n) {
    return pow(value, 1.0 / n);
}


// Functions for Logarithmic Operations
double logBase10(double value) {
    return log10(value);
}

double logBaseE(double value) {
    return log(value);
}

double logCustomBase(double value, double base) {
    if (base <= 0 || base == 1 || value <= 0) {
        cout << "Error: Invalid base or value for logarithm." << endl;
        return 0;
    }
    return log(value) / log(base);
}

// Functions for Statistical Operations

double mean(const vector<double>& nums) {
    double sum = 0;
    for (double num : nums) {
        sum += num;
    }
    return sum / nums.size();
}

double median(vector<double> nums) {
    sort(nums.begin(), nums.end());
    size_t size = nums.size();
    if (size % 2 == 0) {
        return (nums[size / 2 - 1] + nums[size / 2]) / 2;
    } else {
        return nums[size / 2];
    }
}

double mode(const vector<double>& nums) {
    map<double, int> frequency;
    for (double num : nums) {
        frequency[num]++;
    }

    double mode = nums[0];
    int maxCount = 0;
    for (auto& elem : frequency) {
        if (elem.second > maxCount) {
            maxCount = elem.second;
            mode = elem.first;
        }
    }
    return mode;
}

double variance(const vector<double>& nums) {
    double meanValue = mean(nums);
    double sum = 0;
    for (double num : nums) {
        sum += pow(num - meanValue, 2);
    }
    return sum / nums.size();
}

double standardDeviation(const vector<double>& nums) {
    return sqrt(variance(nums));
}

// Function to read multiple values into a vector
vector<double> readVector() {
    vector<double> nums;
    int count;
    double value;

    cout << "Enter the number of values: ";
    cin >> count;
    cout << "Enter " << count << " numbers:" << endl;
    for (int i = 0; i < count; ++i) {
        cin >> value;
        nums.push_back(value);
    }
    return nums;
}

// Addtional Functions (Part F) 

int modOperation(int a, int b) {
    return a % b;
}

double percentage(double value, double total) {
    return (value / total) * 100;
}

int gcd(int a, int b) {
    while (b != 0) {
        int temp = b;
        b = a % b;
        a = temp;
    }
    return a;
}

int lcm(int a, int b) {
    return (a / gcd(a, b)) * b;
}

int main()
{
  int operation; 
 
  double num1, num2; 
  double angleValue;
  
  cout << "Select The Operation by Entering their Number"<< endl; 
  cout << "1. Add \n2. Subtract \n3. Multiply \n4. Divide\n"; 
  cout << "5. Sine\n6. Cosine\n7. Tangent\n";
  cout << "8. Arcsine\n9. Arccosine\n10. Arctangent\n";
  cout << "11. Exponentiation\n12. Square root\n13. Cube root\n";
  cout << "14. Nth root\n15. Factorial\n16. Absolute value\n";
  cout << "17. Logarithm (base 10)\n18. Natural logarithm (base e)\n";
  cout << "19. Custom base logarithm\n";
  cout << "20. Mean\n21. Median\n22. Mode\n";
  cout << "23. Standard Deviation\n24. Variance\n";
  cout << "25. Modulus\n26. Percentage\n27. GCD\n";
  cout << "28. LCM\n29. Floor\n30. Ceiling\n";
  
  cin>> operation; 

   vector<double> numbers;
int num3;
  
  switch (operation) {
      
      case 1:
      takeInput(num1, num2);
      cout <<" Result: "<< add(num1, num2)<<endl; 
      break;
      
      case 2:
     takeInput(num1, num2);
      cout <<" Result: "<<  subtract(num1, num2)<<endl; 
      break;
      
      case 3:
      takeInput(num1, num2);
      cout <<" Result: "<<  multiply(num1, num2)<<endl; 
      break;
      
      case 4:
      takeInput(num1, num2);
      cout <<" Result: "<<  divide(num1, num2)<<endl;
      break; 
      
      case 5:
            cout << "Enter angle in degrees: ";
            cin >> angleValue;
            cout << "Sine: " << sine(angleValue) << endl;
            break;
        case 6:
            cout << "Enter angle in degrees: ";
            cin >> angleValue;
            cout << "Cosine: " << cosine(angleValue) << endl;
            break;
        case 7:
            cout << "Enter angle in degrees: ";
            cin >> angleValue;
            cout << "Tangent: " << tangent(angleValue) << endl;
            break;
        case 8:
            cout << "Enter value: ";
            cin >> angleValue;
            cout << "Arcsine: " << arcsine(angleValue) << " radians" << endl;
            break;
        case 9:
            cout << "Enter value: ";
            cin >> angleValue;
            cout << "Arccosine: " << arccosine(angleValue) << " radians" << endl;
            break;
        case 10:
            cout << "Enter value: ";
            cin >> angleValue;
            cout << "Arctangent: " << arctangent(angleValue) << " radians" << endl;
            break;

        case 11:
            cout << "Enter base and exponent: ";
            cin >> num1 >> num2;
            cout << "Result: " << pow(num1, num2) << endl;
            break;
        case 12:
            cout << "Enter number: ";
            cin >> num1;
            cout << "Square Root: " << sqrt(num1) << endl;
            break;
        case 13:
            cout << "Enter number: ";
            cin >> num1;
            cout << "Cube Root: " << cbrt(num1) << endl;
            break;
        case 14:
            cout << "Enter number and root: ";
            cin >> num1 >> num2;
            cout << "Nth Root: " << nthRoot(num1, num2) << endl;
            break;
        case 15:
            int n;
            cout << "Enter a non-negative integer: ";
            cin >> n;
            if (n >= 0) {
                cout << "Factorial: " << factorial(n) << endl;
            } else {
                cout << "Error: Negative number for factorial." << endl;
            }
            break;
        case 16:
            cout << "Enter number: ";
            cin >> num1;
            cout << "Absolute Value: " << abs(num1) << endl;
            break;

        case 17:
            cout << "Enter number: ";
            cin >> num1;
            if (num1 > 0) {
                cout << "Logarithm (base 10): " << logBase10(num1) << endl;
            } else {
                cout << "Error: Logarithm for non-positive number." << endl;
            }
            break;
        case 18:
            cout << "Enter number: ";
            cin >> num1;
            if (num1 > 0) {
                cout << "Natural logarithm (base e): " << logBaseE(num1) << endl;
            } else {
                cout << "Error: Logarithm for non-positive number." << endl;
            }
            break;
        case 19:
            double base;
            cout << "Enter number and base: ";
            cin >> num1 >> base;
            cout << "Custom base logarithm: " << logCustomBase(num1, base) << endl;
            break;

        case 20:
            numbers = readVector();
            cout << "Mean: " << mean(numbers) << endl;
            break;
        case 21:
            numbers = readVector();
            cout << "Median: " << median(numbers) << endl;
            break;
        case 22:
            numbers = readVector();
            cout << "Mode: " << mode(numbers) << endl;
            break;
        case 23:
            numbers = readVector();
            cout << "Standard Deviation: " << standardDeviation(numbers) << endl;
            break;
        case 24:
            numbers = readVector();
            cout << "Variance: " << variance(numbers) << endl;
            break;

case 25:
            cout << "Enter two integers: ";
            cin >> num1 >> num3;
            cout << "Modulus: " << modOperation(num1, num3) << endl;
            break;
        case 26:
            cout << "Enter value and total: ";
            cin >> num1 >> num2;
            cout << "Percentage: " << percentage(num1, num2) << " %" << endl;
            break;
        case 27:
            cout << "Enter two integers: ";
            cin >> num1 >> num3;
            cout << "GCD: " << gcd(num1, num3) << endl;
            break;
        case 28:
            cout << "Enter two integers: ";
            cin >> num1 >> num3;
            cout << "LCM: " << lcm(num1, num3) << endl;
            break;
        case 29:
            cout << "Enter a decimal number: ";
            cin >> num1;
            cout << "Floor: " << floor(num1) << endl;
            break;
        case 30:
            cout << "Enter a decimal number: ";
            cin >> num1;
            cout << "Ceiling: " << ceil(num1) << endl;
            break;
      
      default:
      cout << "Invalid Operator!"<< endl; 
  }
  
  return 0; 
}
